<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="第1章 入门目标
Spring Boot提供了一种新的编程范式，能在最小的阻力下开发Spring程序。专注于应用程序功能，不用在Spring配置上多花功夫。
Spring2.5有基于注解的组件扫描；Spring3.0引入了基于Java的配置（一种类型安全的可重构配置方式，可代替XML）。
组件扫描减">
    

    <!--Author-->
    
        <meta name="author" content="mamian">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="《Spring Boot实战》读书笔记"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="马面"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

        <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>《Spring Boot实战》读书笔记 - 马面</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    


</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">马面</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives/index.html">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags/index.html">
                            
                                Tags
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories/index.html">
                            
                                Categories
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/about/index.html">
                            
                                About
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/mamian">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('http://www.codeblocq.com/assets/projects/hexo-theme-clean-blog/img/home-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>《Spring Boot实战》读书笔记</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        2017-04-14
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/springboot/">#springboot</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <h1 id="第1章-入门"><a href="#第1章-入门" class="headerlink" title="第1章 入门"></a><center>第1章 入门</center></h1><h3 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h3><ul>
<li>Spring Boot提供了一种新的编程范式，能在最小的阻力下开发Spring程序。专注于应用程序功能，不用在Spring配置上多花功夫。<ul>
<li>Spring2.5有基于注解的组件扫描；Spring3.0引入了基于Java的配置（一种类型安全的可重构配置方式，可代替XML）。</li>
<li>组件扫描减少了配置量，Java配置让它看上去简洁不少，但Spring还是需要不少配置。</li>
<li>但依然还需要很多配置：<ul>
<li>如事务管理和SpringMVC，还是需要XML或Java显式配置；</li>
<li>配置Servlet和过滤器（如Spring的DispatcherServlet）同样需在web.xml或Servlet初始化代码里进行显式配置。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h3><ul>
<li><code>快速开发能力</code><ul>
<li>Spring Boot的目标是使用更少的代码，更快地写出好的生产系统。</li>
</ul>
</li>
<li><code>强大运维能力</code><ul>
<li>Spring Boot在运维方面做了很多工作，部署、监控、度量，结合Spring Cloud还可轻松实现服务发现、服务降级。</li>
</ul>
</li>
</ul>
<h3 id="springboot特性"><a href="#springboot特性" class="headerlink" title="springboot特性"></a>springboot特性</h3><ul>
<li><code>自动配置</code>：spring常见的应用功能，自动提供相关<strong><em>配置</em></strong><ul>
<li>数据库、Java持久化API、Thymeleaf模板、安全、springMVC等，不用再写Java或XML配置</li>
</ul>
</li>
<li><code>起步依赖</code>：只需告诉springboot需要什么功能，就能引入需要的库且无版本冲突。<ul>
<li>spring-core、spring-web、spring-webmvc、jackson-databind、hibernate-validator等。</li>
</ul>
</li>
<li><code>Actuator</code>：了解运行中的springboot程序。可通过Shell、web端点提供信息。<ul>
<li>Spring应用程序上下文里配置的Bean</li>
<li>SpringBoot的自动配置做的决策</li>
<li>应用程序取到的环境变量、系统属性、配置属性和命令行参数</li>
<li>应用程序里线程的当前状态</li>
<li>应用程序最近处理过的http请求的追踪情况</li>
<li>各种和内存用户、垃圾回收、web请求以及数据源用量相关的指标</li>
</ul>
</li>
<li><code>命令行界面（不常用）</code>：SpringBoot Cli</li>
</ul>
<h3 id="与spring的关系"><a href="#与spring的关系" class="headerlink" title="与spring的关系"></a>与spring的关系</h3><ul>
<li>就是spring，只不过省略了在使用spring时始终需要去做的Spring Bean配置。</li>
</ul>
<hr>
<h1 id="第2章-开发springboot项目"><a href="#第2章-开发springboot项目" class="headerlink" title="第2章 开发springboot项目"></a><center>第2章 开发springboot项目</center></h1><h3 id="初始化方式"><a href="#初始化方式" class="headerlink" title="初始化方式"></a>初始化方式</h3><ul>
<li><code>[web方式](http://start.spring.io)</code></li>
<li><code>Intellij IDEA</code></li>
<li>Spring tool suite</li>
<li>Spring Boot CLI</li>
</ul>
<h3 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h3><pre><code>+ src
    + main
        + java
            + com.example
                - DemoApplication.java
        + resources
            - application.properties
            + static
            + templates
    + test
        + java
            + com.example
                - DemoApplicationTests.java
- pom.xml
</code></pre><ul>
<li>DemoApplication.java<ul>
<li>程序起动引导类</li>
<li>@SpringBootApplication 开启<code>组件扫描</code>和<code>自动配置</code>功能。相当于spring中的@Configuration、@ComponentScan、@EnableAutoConfiguration之和。</li>
<li>main方法中调用SpringApplication.run来启动引导应用程序</li>
</ul>
</li>
<li>application.properties 配置信息<ul>
<li>server.port=8080</li>
</ul>
</li>
<li>构建<ul>
<li>mvn spring-boot:run</li>
</ul>
</li>
</ul>
<h3 id="使用起步依赖"><a href="#使用起步依赖" class="headerlink" title="使用起步依赖"></a>使用起步依赖</h3><ul>
<li>起步依赖本质上是一个maven项目对象模型（POM），定义了对其他库的传递依赖，这些东西加在一起即支持某项功能。</li>
<li><code>不需要指定版本号</code>：起步依赖版本由spring boot的版本决定；起步依赖决定它们引入的传递依赖的版本。</li>
<li>可以显示指定版本进行覆盖。</li>
</ul>
<h3 id="使用自动配置"><a href="#使用自动配置" class="headerlink" title="使用自动配置"></a>使用自动配置</h3><ul>
<li>spring boot的自动配置是一个运行时（准确地说，是应用程序启动时）的过程。</li>
<li><p>一般代码结构</p>
<pre><code>+ @Entity
    - @Id、@GeneratedValue(strategy=GenerationType.AUTO)
+ JpaRepository
+ service
+ controller
</code></pre></li>
<li>自动配置的实现：使用了spring的条件化配置Contition<ul>
<li>自定义Contition类public class JdbcTemplateCondition implements Condition</li>
<li>在Bean上加注解：@Conditional(JdbcTemplateCondition.class)，则只有满足条件，此Bean才会创建</li>
</ul>
</li>
</ul>
<hr>
<h1 id="第3章-自定义配置"><a href="#第3章-自定义配置" class="headerlink" title="第3章 自定义配置"></a><center>第3章 自定义配置</center></h1><h3 id="覆盖Spring-Boot自动配置"><a href="#覆盖Spring-Boot自动配置" class="headerlink" title="覆盖Spring Boot自动配置"></a>覆盖Spring Boot自动配置</h3><ul>
<li>大多数情况下，自动配置的Bean可满足需要。但有时需显示配置来覆盖自动配置。</li>
</ul>
<h5 id="安全配置：保护应用程序"><a href="#安全配置：保护应用程序" class="headerlink" title="安全配置：保护应用程序"></a>安全配置：保护应用程序</h5><pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre><ul>
<li>添加如上依赖后，会使用HTTP基础身份验证，但不友好。<ul>
<li>用户名：user</li>
<li>密码在启动时，日志中打出：Using default security password: c70e829a-b9ae-4ccb-90b3-c904c7e3b2d4</li>
</ul>
</li>
</ul>
<h5 id="创建自定义的安全配置"><a href="#创建自定义的安全配置" class="headerlink" title="创建自定义的安全配置"></a>创建自定义的安全配置</h5><ul>
<li><p>当自动配置不存在，直接显式写配置。spring支持的xml形式即可，但Java形式的配置更优雅一些。</p>
<pre><code>@Configuration
@EnableWebSecurity
public class SecurityConfig extends WebSecurityConfigurerAdapter
</code></pre></li>
</ul>
<h5 id="掀开自动配置的神秘面纱"><a href="#掀开自动配置的神秘面纱" class="headerlink" title="掀开自动配置的神秘面纱"></a>掀开自动配置的神秘面纱</h5><ul>
<li><p>spring boot的设计是加载应用级配置，随后再考虑自动配置类。</p>
<pre><code>@Configuration
@EnableConfigurationProperties
@ConditionalOnClass({ EnableWebSecurity.class })         @ConditionalOnMissingBean(WebSecurityConfiguration.class)         @ConditionalOnWebApplication
public class SpringBootWebSecurityConfiguration 
</code></pre></li>
</ul>
<h3 id="通过属性文件外置配置"><a href="#通过属性文件外置配置" class="headerlink" title="通过属性文件外置配置"></a>通过属性文件外置配置</h3><ul>
<li>微调细节，放弃自动配置不合算。直接通过外置配置来修改<ul>
<li>application.properties</li>
<li>java -jar XXX.jar –server.port=18000</li>
<li>通过@PropertySource标注的属性源</li>
</ul>
</li>
</ul>
<h5 id="自动配置微调"><a href="#自动配置微调" class="headerlink" title="自动配置微调"></a>自动配置微调</h5><ul>
<li>禁用模板缓存<ul>
<li>开发过程中禁用thymeleaf模板缓存：spring.thymeleaf.cache=false</li>
</ul>
</li>
<li>配置嵌入式服务器<ul>
<li>server.port=18000</li>
<li>启用ssl<ul>
<li>使用JDK的keytool工具创建keystore：keytool -keystore mykeys.jks -genkey -alias tomcat -keyalg RSA</li>
<li>server.ssl.key-store=file:///path/mykeys.jks</li>
<li>server.ssl.key-store-password=XXX</li>
<li>server.ssl.key-password=XXX</li>
</ul>
</li>
</ul>
</li>
<li>配置日志<ul>
<li>默认使用logback，info级别</li>
<li>自定义日志配置：在classpath根目录（src/main/resources）创建logback.xml</li>
<li>也可以在不创建logback.xml文件情况下通过修改application.properties实现</li>
</ul>
</li>
<li>配置数据源<ul>
<li>application.properties无需指定驱动，spring boot会根据数据库URL自动实别。</li>
</ul>
</li>
</ul>
<h5 id="应用程序Bean的配置外置"><a href="#应用程序Bean的配置外置" class="headerlink" title="应用程序Bean的配置外置"></a>应用程序Bean的配置外置</h5><pre><code>@Component
@ConfigurationProperties(&quot;amazon&quot;)
public class AmazonProperties {
    private String associateId;
}
</code></pre><ul>
<li>ConfigurationProperties注解表明此Bean从配置属性值注入前缀为amazon的属性</li>
<li>application.properties中增加amazon.associateId=XXX，那么此Bean即可获取到</li>
<li>spring boot的属性解析器，将associateId、associate_id、associate-id视为相同</li>
</ul>
<h5 id="使用Profile进行配置"><a href="#使用Profile进行配置" class="headerlink" title="使用Profile进行配置"></a>使用Profile进行配置</h5><ul>
<li>应用程序布署到多个环境（dev、qa、stage、product），配置细节可能不同。Spring的Profile配置是条件化配置，基于运行时激活Profile使用不同的Bean或配置类。</li>
<li><p>如下需在运行时激活production Profile才能使用此配置</p>
<pre><code>@Profile(&quot;production&quot;)
@Configuration
@EnableWebSecurity
public class SecurityConfig extends WebSecurityConfigurerAdapter {
}
</code></pre></li>
<li>设置<code>spring.profiles.active=production</code>也可激活</li>
<li>若使用application.properties，可创建application-{profile}.properties格式的文件，即可提供特定于profile的属性</li>
</ul>
<h3 id="定制应用程序错误页面"><a href="#定制应用程序错误页面" class="headerlink" title="定制应用程序错误页面"></a>定制应用程序错误页面</h3><ul>
<li>Spring Boot自动配置的默认错误处理器会查找名为error的视图(页面)，如不存在则使用默认错误页Whitelabel Error Page</li>
<li>如使用Thymeleaf，则需error.html，不需要单独写path为error的rest接口。</li>
<li>error视图可获取的信息<ul>
<li>timestamp：错误发生的时间</li>
<li>status：HTTP状态码</li>
<li>error：错误原因    </li>
<li>exception：异常的类名</li>
<li>message：异常消息（如果这个错误是由异常引起的）</li>
<li>errors：BindingResult异常里的各种错误（如果这个错误是由异常引起的）</li>
<li>trace：异常跟踪信息（如果这个错误是由异常引起的）</li>
<li>path：错误发生时请求的URL路径</li>
</ul>
</li>
<li><p>demo</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot; xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;/&gt;
    &lt;title&gt;这是一个错误页面&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; th:href=&quot;@{/css/index.css}&quot; /&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;p&gt;错误发生时间：&lt;span th:text=&quot;${timestamp}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
    &lt;p&gt;http状态：&lt;span th:text=&quot;${status}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
    &lt;p&gt;错误原因：&lt;span th:text=&quot;${error}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
    &lt;p&gt;异常类：&lt;span th:text=&quot;${exception}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
    &lt;p&gt;请求路径：&lt;span th:text=&quot;${path}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
    &lt;p th:text=&quot;${&apos;错误详情: &apos; + message}&quot;&gt;&lt;/p&gt;
    &lt;p&gt;BindingResult异常里的各种错误：&lt;span th:text=&quot;${errors}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
    &lt;p&gt;异常跟踪信息：&lt;span th:text=&quot;${trace}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
</code></pre></li>
</ul>
<pre><code>    &lt;div class=&quot;copyright&quot;&gt;
        &lt;p&gt;
            &lt;a href=&quot;http://www.mamian.net/&quot;&gt;www.mamian.net&lt;/a&gt;
            &lt;a href=&quot;http://www.miibeian.gov.cn/&quot; target=&quot;_blank&quot; style=&quot;margin-left:10px&quot;&gt;京ICP备15014219号&lt;/a&gt;
        &lt;/p&gt;
    &lt;/div&gt;
    &lt;div class=&quot;copyright&quot;&gt;
        &lt;p&gt;
            © 2016&amp;nbsp;&amp;nbsp;马面&amp;nbsp;&amp;nbsp;All Rights Reserved
        &lt;/p&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<h1 id="第4章-测试"><a href="#第4章-测试" class="headerlink" title="第4章 测试"></a><center>第4章 测试</center></h1><hr>
<h1 id="第5章-Groovy与Spring-Boot-Cli"><a href="#第5章-Groovy与Spring-Boot-Cli" class="headerlink" title="第5章 Groovy与Spring Boot Cli"></a><center>第5章 Groovy与Spring Boot Cli</center></h1><hr>
<h1 id="第6章-Spring-Boot-Grails"><a href="#第6章-Spring-Boot-Grails" class="headerlink" title="第6章 Spring Boot+Grails"></a><center>第6章 Spring Boot+Grails</center></h1><hr>
<h1 id="第7章-Actuator"><a href="#第7章-Actuator" class="headerlink" title="第7章 Actuator"></a><center><a href="http://blog.didispace.com/spring-boot-actuator-1/" target="_blank" rel="external">第7章 Actuator</a></center></h1><ul>
<li>作用：暴露自身信息，提供系统监控数据</li>
<li>使用方式<ul>
<li><code>rest端点(最常用)</code></li>
<li>远程shell</li>
<li>JMX</li>
</ul>
</li>
</ul>
<h3 id="Actuator端点"><a href="#Actuator端点" class="headerlink" title="Actuator端点"></a>Actuator端点</h3><ul>
<li>Actuator提供众多Web端点，用以了解应用程序内部状态。<ul>
<li>应用配置类：获取应用程序中加载的应用配置、环境变量、自动化配置报告等与Spring Boot应用密切相关的配置类信息。</li>
<li>度量指标类：获取应用程序运行过程中用于监控的度量指标，比如：内存信息、线程池信息、HTTP请求统计等。</li>
<li>操作控制类：提供了对应用的关闭等操作类功能。</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>HTTP方法</th>
<th>路径</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/autoconfig</td>
<td>提供自动配置报告，记录哪些自动配置条件通过了，哪些没通过</td>
</tr>
<tr>
<td>GET</td>
<td>/configprops</td>
<td>描述配置属性（包含默认值）如何注入Bean</td>
</tr>
<tr>
<td>GET</td>
<td>/beans</td>
<td>描述应用程序上下文里全部的Bean，以及它们的关系</td>
</tr>
<tr>
<td>GET</td>
<td>/dump</td>
<td>获取线程活动的快照</td>
</tr>
<tr>
<td>GET</td>
<td>/env</td>
<td>获取全部环境属性</td>
</tr>
<tr>
<td>GET</td>
<td>/env/{name}</td>
<td>根据名称获取特定的环境属性值</td>
</tr>
<tr>
<td>GET</td>
<td>/health</td>
<td>报告应用程序的健康指标，这些值由HealthIndicator的实现类提供</td>
</tr>
<tr>
<td>GET</td>
<td>/info</td>
<td>获取应用程序的定制信息，这些信息由info打头的属性提供</td>
</tr>
<tr>
<td>GET</td>
<td>/mappings</td>
<td>描述全部的URI路径，以及它们和控制器（包含Actuator端点）的映射关系</td>
</tr>
<tr>
<td>GET</td>
<td>/metrics</td>
<td>报告各种应用程序度量信息，比如内存用量和HTTP请求计数</td>
</tr>
<tr>
<td>GET</td>
<td>/metrics/{name}</td>
<td>报告指定名称的应用程序度量值</td>
</tr>
<tr>
<td>POST</td>
<td>/shutdown</td>
<td>关闭应用程序，要求endpoints.shutdown.enabled设置为true</td>
</tr>
<tr>
<td>GET</td>
<td>/trace</td>
<td>提供基本的HTTP请求跟踪信息（时间戳、HTTP头等）</td>
</tr>
</tbody>
</table>
<ul>
<li><p>引用方式</p>
<pre><code>&lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></li>
</ul>
<h5 id="查看配置明细"><a href="#查看配置明细" class="headerlink" title="查看配置明细"></a>查看配置明细</h5><ul>
<li>获得Bean装配报告(/beans)<ul>
<li>spring应用程序上下文中有哪些bean，每个bean的resource、dependencies、scope、type、name</li>
</ul>
</li>
<li>详解自动配置(/autoconfig)<ul>
<li>为什么会有某个Bean或为什么没有。</li>
</ul>
</li>
<li>查看配置属性(/env)<ul>
<li>所有环境属性列表：环境变量、JVM属性、命令行参数、applicaition.properties属性</li>
<li>出于安全性，所有名为password、secret、key（或名字中最后一段是这些），返回“*”</li>
</ul>
</li>
<li>生成端点到控制器的映射(/mappings)</li>
</ul>
<h5 id="运行时度量"><a href="#运行时度量" class="headerlink" title="运行时度量"></a>运行时度量</h5><ul>
<li>查看应用程序的度量值（/metrics）</li>
</ul>
<table>
<thead>
<tr>
<th>分类</th>
<th>前缀</th>
<th>报告内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>垃圾收集器</td>
<td>gc.*</td>
<td>已经发生过的垃圾收集次数，以及垃圾收集所耗时间，适用于标记-清理、并行收集器</td>
</tr>
<tr>
<td>内存</td>
<td>mem.*</td>
<td>分配给应用程序的内存数量和空闲内存数量（数据来自java.lang.Runtime）</td>
</tr>
<tr>
<td>堆</td>
<td>heap.*</td>
<td>当前内存用量（数据来自java.lang.management.MemoryUsage）</td>
</tr>
<tr>
<td>类加载器</td>
<td>classes.*</td>
<td>JVM类加载器加载与缷载的类数量（数据来自java.lang.management.ClassLoadingMXBean）</td>
</tr>
<tr>
<td>系统</td>
<td>processors uptime instance.uptime systemload.average</td>
<td>系统信息：处理器数（java.lang.Runtime）、运行时间（java.lang.management.RuntimeMXBean）、平均负载（java.lang.management.OperationSystemMXBean）</td>
</tr>
<tr>
<td>线程池</td>
<td>threads.*</td>
<td>线程、守护线程数，jvm启动后线程数峰值（java.lang.management.ThreadMXBean）</td>
</tr>
<tr>
<td>数据源</td>
<td>datasource.*</td>
<td>数据源连接的数量（源自数据源的元数据，仅当spring应用程序上下文里存在DataSource Bean时才会有这个信息）</td>
</tr>
<tr>
<td>tomcat会话</td>
<td>httpsessions.*</td>
<td>tomcat活跃会话数和最大会话数（数据源自嵌入式tomcat的bean，仅在使用嵌入式tomcat时才有此信息）</td>
</tr>
<tr>
<td>HTTP</td>
<td>counter.status.<em> gauge.response.</em></td>
<td>多种应用程序服务http请求的度量值与计数器</td>
</tr>
</tbody>
</table>
<ul>
<li><p>追踪Web请求（/trace）</p>
<ul>
<li>web请求的方法、路径、时间戮、请求响应头信息</li>
</ul>
</li>
<li><p>导出线程活动（/dump）</p>
<ul>
<li>当前线程活动的快照</li>
</ul>
</li>
<li><p>监控应用程序健康情况（/health）</p>
</li>
</ul>
<h5 id="关闭应用程序（-shutdown）"><a href="#关闭应用程序（-shutdown）" class="headerlink" title="关闭应用程序（/shutdown）"></a>关闭应用程序（/shutdown）</h5><ul>
<li>微服务架构中，某个实例异常需关闭，则可直接post关闭</li>
<li>shutdown默认没有启动，通过endpoints.shutdown.enabled=true开启</li>
</ul>
<h5 id="获取应用信息（-info）"><a href="#获取应用信息（-info）" class="headerlink" title="获取应用信息（/info）"></a>获取应用信息（/info）</h5><ul>
<li>在application.properties中设置info前缀的属性后，通过/info可获取到</li>
</ul>
<h3 id="连接Actuator的远程shell"><a href="#连接Actuator的远程shell" class="headerlink" title="连接Actuator的远程shell"></a>连接Actuator的远程shell</h3><ul>
<li>通过远程shell来查询Actuator端点信息</li>
</ul>
<h3 id="通过JMX监控应用程序"><a href="#通过JMX监控应用程序" class="headerlink" title="通过JMX监控应用程序"></a>通过JMX监控应用程序</h3><h3 id="定制Actuator"><a href="#定制Actuator" class="headerlink" title="定制Actuator"></a>定制Actuator</h3><ul>
<li>重命名端点</li>
<li>启用和禁用端点</li>
<li>自定义度量信息</li>
<li>创建自定义仓库来存储跟踪数据</li>
<li>插入自定义的健康指示器</li>
</ul>
<h3 id="保护Actuator端点"><a href="#保护Actuator端点" class="headerlink" title="保护Actuator端点"></a>保护Actuator端点</h3><ul>
<li>application.properties中增加management.context-path=/mgmt，则所有Actuator端点均增加/mgmt前缀</li>
<li>使用Spring Security来保护/mgmt前缀的所有端点即可</li>
</ul>
<hr>
<h1 id="第8章-部署SpringBoot应用程序"><a href="#第8章-部署SpringBoot应用程序" class="headerlink" title="第8章 部署SpringBoot应用程序"></a>第8章 <center>部署SpringBoot应用程序</center></h1><h3 id="构建、运行方式"><a href="#构建、运行方式" class="headerlink" title="构建、运行方式"></a>构建、运行方式</h3><ul>
<li>IDE(Spring ToolSuite、idea)</li>
<li>命令行：代码目录下 <code>mvn spring-boot:run</code></li>
<li>maven编译成jar，命令行运行</li>
<li>Spring Boot CLI</li>
<li>编译成war，交给tomcat、jetty</li>
</ul>
<h3 id="布署到传统应用服务器（如tomcat）"><a href="#布署到传统应用服务器（如tomcat）" class="headerlink" title="布署到传统应用服务器（如tomcat）"></a>布署到传统应用服务器（如tomcat）</h3><ul>
<li>与传统web应用程序相反，将tomcat部署到了应用程序中。</li>
<li>由于自动配置功能，springboot不需web.xml或Servlet初始化类来声明springMVC的DispatcherServlet。如直接编译为war，则无效，还要一个对Servlet初始化的东西。<ul>
<li>将<packaging>jar</packaging>修改为<packaging>war</packaging><ul>
<li>此时war中没启用Spring MVC DispatcherServlet的web.xml或Servlet初始化类，war文件还不可用。需使用SpringBootServletInitializer</li>
</ul>
</li>
<li>SpringBootServletInitializer<ul>
<li>作用1：配置Spring DispatcherServlet</li>
<li>作用2：在Spring应用程序上下文里查找Filter、Servlet或ServletContextInitializer类型的Bean,把它们绑定到Servlet容器里。</li>
<li>使用方法：创建类继承自SpringBootServletInitializer并覆盖其configure方法即可。<ul>
<li>configure方法只注册了一个Application类，这就够了。没必要把其他的Spring配置类也注册进来，因为Application类上添加了@SpringBootApplication注解。这会隐性开启组件扫描，而组件扫描则会发现并应用其他配置类。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code>public class ReadingListServletInitializer extends SpringBootServletInitializer {
      @Override
      protected SpringApplicationBuilder configure(SpringApplicationBuilder builder) {
        return builder.sources(Application.class);
    }

}
</code></pre><hr>
<h1 id="附录A-开发者工具"><a href="#附录A-开发者工具" class="headerlink" title="附录A 开发者工具"></a><center>附录A 开发者工具</center></h1><p><dependency><br>  <groupid>org.springframework.boot</groupid><br>  <artifactid>spring-boot-devtools</artifactid><br></dependency><br>当用应程序以完整打包好的jar或war文件形式运行时，开发者工具会被禁用，所以没必要在构建生产包前移除依赖。</p>
<ul>
<li>作用<ul>
<li>自动重启：classpath里文件变化时重启应用</li>
<li>live reload：资源修改后自动刷新浏览器</li>
<li>远程开发：远程部署时支持自动重启与live reload。</li>
<li>默认的开发时属性值</li>
</ul>
</li>
<li>自动重启<ul>
<li>不会修改的类（如三方jar包）加载到基础类加载器，应用程序的代码加载到单独的<code>重启类加载器</code>中。检测到变更时，只有重启类加载器重启。</li>
<li>不是所有classpath里资源变更后都会重启应用，如thymeleaf视图、static及public里静态资源。重启时会排除：/META-INF/resources、/resources、/static、/public、/templates。</li>
<li>设置spring.devtools.restart.exclude来覆盖默认的重启排除目录<br>  spring:<pre><code>devtools:
    restart:
        exclude:/static/**,/templates/**
</code></pre></li>
<li>关闭重启功能：<br>  spring:<pre><code>devtools:
    restart:
        enable:false
</code></pre></li>
<li>仅修改某类文件时才重启：<br>  spring:<pre><code>devtools:
    restart:
        trigger-file:.trigger
</code></pre></li>
</ul>
</li>
<li>live reload<ul>
<li>集成了<a href="http://livereload.com" target="_blank" rel="external">LiveReload</a></li>
<li>激活开发工具后，springboot启动内嵌的LiveReload服务器，在资源文件发生变化时触发浏览器刷新。但需在浏览器里安装LiveReload插件。</li>
<li>禁用内嵌的LiveReload服务器<br>  spring:<pre><code>devtools:
    livereload:
        enable:false
</code></pre></li>
</ul>
</li>
<li><p>远程开发</p>
<ul>
<li>在远程dev环境上布署比较适合，可远程调试应用。支持自动重启、live reload。</li>
<li>开启远程开发功能需设置远程安全码<br>  spring:<pre><code>devtools:
    remote:
        secret:mamian
</code></pre></li>
<li>开启后，运行中的应用会启动一个服务器组件以监听接受变更的请求，可重启应用程序或触发浏览器刷新。</li>
<li>需在本地运行远程开发工具的客户端（就是一个Java类org.springframework.boot.devtools.RemoteSpringApplication）。它会运行在IDE中，要求提供一个参数，告知远程应用部署在哪。</li>
</ul>
</li>
<li><p>默认的开发时属性</p>
<ul>
<li>有些属性仅在开发环境生效：如视图模板缓存在开发时需关掉以支持实时看到修改后的结果。</li>
<li>当开发者工具激活后，以下属性会设置为false（如未开启开发者工具，默认为true）。这样就不需要在开发时使用Profile配置来禁用它们了。<ul>
<li>spring.thymeleaf.cache</li>
<li>spring.freemarker.cache</li>
<li>spring.velocity.cache</li>
<li>spring.mustache.cache</li>
<li>spring.groovy.template.cache</li>
</ul>
</li>
</ul>
</li>
<li>全局配置开发者工具        <ul>
<li>同时开发多个项目，想使用相同的设置。</li>
<li>在主目录(home directory)里创建<code>.spring-boot-devtools.properties</code>文件。如下内容<ul>
<li>spring.devtools.restart.trigger-file=.trigger</li>
<li>spring.devtools.livereload.enabled=false</li>
</ul>
</li>
<li>每个项目中的application.properties或application.yml可覆盖这些属性。</li>
</ul>
</li>
</ul>
<hr>


                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


    <hr />
    <h3>Kommentare:</h3>
    <div id="fb-root"></div>
    <script>
        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=397462077298331";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    </script>

    <div class="fb-comments" data-href="http://www.mamian.net/2017/04/14/《Spring-Boot实战》读书笔记/index.html" data-num-posts="5" data-width="100%" data-colorscheme="light"></div>


                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/mamian" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    

                    
                </ul>
                <p class="copyright text-muted">© 2016  <a href="http://www.mamian.net/" target="_blank">mamian</a>  All Rights Reserved</p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>